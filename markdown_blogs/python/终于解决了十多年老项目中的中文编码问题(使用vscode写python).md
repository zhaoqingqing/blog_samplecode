在vscode中解决了我遇到的编码问题，此方法无需安装插件使用vscode自带的功能即可设置，本文记录一下解决方法。

## 问题起源

我在一个十七年的老项目，一些py脚本的第一行指定了utf-8编码，但文件编码是GB2312或GB18030。这样在pycharm中打开py文件，那么中文就会显示乱码，因为我用的pycharm2020社区版不能切换文件编码，只能统一对项目设置编码。

PS.项目代码量很庞大而且是线上项目，统一修改文件编码的成本比较大。

​      

## 解决办法

点击 文件 -> 首选项 -> 设置 -> 文件夹xx，搜索encoding，取消勾选Auto Guess Encoding，并设置Encoding为项目指定的编码，如下图所示：

![为文件夹创建配置文件](https://img2020.cnblogs.com/blog/363476/202108/363476-20210818141055527-104951889.png)

这样操作后会在当前代码目录下生成一个.vscode文件夹，里面会生成一个settings.json，这个配置文件只对当前目录生效，而c盘下的settings.json是对全局生效。

我建议可以把.vscode目录提交到svn或git，可以统一同事的编码环境。

​     

### 添加多个文件夹到工作区

如果上面的设置中没有 **xx文件夹**？因为你打开的是文件夹，要把它转换为工作区，方法如下：

1. 点击 文件 - 将工作区另存为，然后把工作区配置文件保存到当前文件 夹下
2. 点击 文件 - 将文件夹添加到工作区，选择当前目录，即可
3. 当你对文件夹配置了特定的设置之后，就会在当前文件夹下生成一个.vscode目录



这个工作区简单点理解就是vs里面的解决方案(.sln)，或者rider中的.idea文件夹

## 终极解决办法

如果上面的方法还是不能解决，则针对全部进行设置。这样设置后对于其它编码规范(文件头和文件编码一致)打开也是正确的。

点击 文件 -> 首选项 -> 设置 ，搜索encoding，勾选Auto Guess Encoding，并设置Encoding为项目指定的编码，如下图所示：

![设置Encoding](https://img2020.cnblogs.com/blog/363476/202109/363476-20210927102730916-1545106783.png)

## vscode版本信息

版本: 1.59.0 (user setup)
提交: 379476f0e13988d90fab105c5c19e7abc8b1dea8
日期: 2021-08-04T23:13:12.822Z
Electron: 13.1.7
Chrome: 91.0.4472.124
Node.js: 14.16.0
V8: 9.1.269.36-electron.0
OS: Windows_NT x64 10.0.19042